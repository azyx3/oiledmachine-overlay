--- a/amd/amdgpu/dce_v8_0.c.orig	2019-10-03 05:15:41.438117581 -0700
+++ b/amd/amdgpu/dce_v8_0.c	2019-10-03 05:37:11.748840572 -0700
@@ -1623,10 +1623,11 @@ static void dce_v8_0_afmt_setmode(struct
 	dce_v8_0_afmt_audio_select_pin(encoder);
 	dce_v8_0_audio_write_sad_regs(encoder);
 	dce_v8_0_audio_write_latency_fields(encoder, mode);
-
-#if defined(HAVE_2ARGS_DRM_HDMI_AVI_INFOFRAME_FROM_DISPLAY_MODE)
+#if DRM_VERSION_CODE >= DRM_VERSION(5, 1, 0)
+	err = drm_hdmi_avi_infoframe_from_display_mode(&frame, connector, mode);
+#elif defined(HAVE_2ARGS_DRM_HDMI_AVI_INFOFRAME_FROM_DISPLAY_MODE) && DRM_VERSION_CODE < DRM_VERSION(4, 14, 0)
 	err = drm_hdmi_avi_infoframe_from_display_mode(&frame, mode);
-#else
+#elif DRM_VERSION_CODE < DRM_VERSION(5, 1, 0)
 	err = drm_hdmi_avi_infoframe_from_display_mode(&frame, mode, false);
 #endif
 	if (err < 0) {
